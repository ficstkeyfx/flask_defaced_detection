BÃ i Viáº¿t
Há»i ÄÃ¡p
Tháº£o Luáº­n










VI
new
ÄÄƒng nháº­p/ÄÄƒng kÃ½
+92
Mai Trung Äá»©c @maitrungduc1410
Theo dÃµi
36.5K 2.0K 67
ÄÃ£ Ä‘Äƒng vÃ o thg 12 20, 2019 7:15 CH 19 phÃºt Ä‘á»c
11.5K
60
13
Dockerize á»©ng dá»¥ng Python, Flask
ContentCreator
ChÃ o má»«ng cÃ¡c báº¡n Ä‘Ã£ quay trá»Ÿ láº¡i vá»›i series há»c Docker vÃ  CICD cá»§a mÃ¬nh ğŸ‘‹ğŸ‘‹
á» bÃ i trÆ°á»›c mÃ¬nh Ä‘Ã£ hÆ°á»›ng dáº«n cÃ¡c báº¡n cÃ¡ch dockerize má»™t á»©ng dá»¥ng NodeJS, Ä‘á»“ng thá»i cÃ¹ng vá»›i Ä‘Ã³ lÃ  má»™t sá»‘ khÃ¡i niá»‡m vÃ  cÃ¢u há»i liÃªn quan trong bÃ i.
á» bÃ i nÃ y chÃºng ta sáº½ tiáº¿p tá»¥c series báº±ng cÃ¡ch thá»±c hÃ nh dockerize má»™t á»©ng dá»¥ng Python Flask nhÃ©.
"Dá»ªNG Dá»ªNG Dá»ªNG, NEXT, NEXT, chuyá»ƒn bÃ i Ã´ng Æ¡iiiii... TÃ´i dev NodeJS PHP chá»© cÃ³ pháº£i Python Ä‘Ã¢u mÃ  care"
Má»¥c Ä‘Ã­ch cá»§a series nÃ y lÃ  mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n há»c Docker, trong bÃ i nÃ y mÃ¬nh nghÄ© cÃ¡c báº¡n hoÃ n toÃ n cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c dÃ¹ báº¡n chÆ°a bao giá» code Python. Do Ä‘Ã³ mÃ¬nh hi vá»ng ráº±ng cÃ¡c báº¡n váº«n sáº½ theo sÃ¡t Ä‘Æ°á»£c series nÃ y, tá»«ng bÃ i tá»«ng bÃ i, vÃ¬ trong má»—i bÃ i sáº½ cÃ³ nhá»¯ng váº¥n Ä‘á» liÃªn quan Ä‘áº¿n Docker mÃ¬nh muá»‘n gá»­i tá»›i cÃ¡c báº¡n.
Báº¯t tay vÃ o lÃ m thÃ´i nÃ o
Tiá»n Setup
Nhá»› check lÃ  cÃ¡c báº¡n Ä‘Ã£ cÃ i Docker vÃ  Docker-compose rá»“i nhÃ©. Náº¿u chÆ°a thÃ¬ nhá»› check láº¡i pháº§n cuá»‘i bÃ i trÆ°á»›c cá»§a mÃ¬nh Ä‘á»ƒ biáº¿t cÃ¡ch cÃ i Ä‘áº·t nhÃ©.
Setup
CÃ¡c báº¡n clone source code á»Ÿ Ä‘Ã¢y vá» nhÃ©.
á» bÃ i nÃ y ta sáº½ chá»‰ quan tÃ¢m tá»›i folder docker-python sau khi clone nhÃ© . á» Ä‘Ã³ mÃ¬nh cÃ³ setup cho cÃ¡c báº¡n má»™t á»©ng dá»¥ng Python dÃ¹ng Flask framework nhÃ© (báº¡n nÃ o dev PHP cÃ³ thá»ƒ coi nÃ³ nhÆ° Laravel cá»§a PHP váº­y )
Náº¿u cÃ¡c báº¡n cÃ³ cÃ i Python á»Ÿ mÃ¡y thÃ¬ cÃ³ thá»ƒ cháº¡y command sau Ä‘á»ƒ cháº¡y project nhÃ©:
pip install -r requirements.txt
python app.py
Má»Ÿ trÃ¬nh duyá»‡t á»Ÿ Ä‘á»‹a chá»‰ localhost:5000 vÃ  cÃ¡c báº¡n sáº½ tháº¥y dÃ²ng Hello World
CÃ²n náº¿u mÃ¡y cÃ¡c báº¡n khÃ´ng cÃ³ Python, thÃ¬ váº«n tuyá»‡t vá»i Ã´ sá» kÃª nhÃ©. Chá»‰ cáº§n cÃ¡c báº¡n Ä‘Ã£ cÃ i Docker vÃ  Docker compose, nhá»¯ng thá»© khÃ¡c cÃ³ hay khÃ´ng cÃ³, khÃ´ng quan trá»ng
Build Docker Image
Váº«n nhÆ° á»Ÿ bÃ i trÆ°á»›c, Ä‘áº§u tiÃªn ta cáº§n táº¡o file cáº¥u hÃ¬nh Dockerfile vÃ  Ä‘á»‹nh nghÄ©a mÃ´i trÆ°á»ng chÃºng ta mong muá»‘n, sau Ä‘Ã³ ta sáº½ build image vÃ  cháº¡y nhÃ©
Cáº¥u hÃ¬nh Dockerfile
á» thÆ° má»¥c docker-python cÃ¡c báº¡n táº¡o file tÃªn lÃ  Dockerfile, bÃªn trong cÃ³ ná»™i dung nhÆ° sau:
FROM python:3.6-alpine

WORKDIR /app

COPY . .

RUN pip install -r requirements.txt

CMD ["python", "app.py"]
Giáº£i thÃ­ch:
DÃ²ng Ä‘áº§u tiÃªn FROM: ta báº¯t Ä‘áº§u tá»« 1 Image cÃ³ mÃ´i trÆ°á»ng Alpint vÃ  Ä‘Ã£ cÃ i sáºµn Python phiÃªn báº£n 3.6. Xem danh sÃ¡ch Image Python á»Ÿ Ä‘Ã¢u, cÃ¡c báº¡n check á»Ÿ link chÃ­nh thá»©c nÃ y nhÃ©
LÃ­ do sao láº¡i chá»n Alpine mÃ  khÃ´ng pháº£i Ubuntu hay Debian, CentOS,.... ThÃ¬ á»Ÿ bÃ i trÆ°á»›c á»Ÿ má»¥c nÃ y mÃ¬nh Ä‘Ã£ phÃ¢n tÃ­ch rá»“i nhÃ©. Äá»“ng thá»i xuyÃªn suá»‘t series nÃ y mÃ¬nh sáº½ luÃ´n dÃ¹ng mÃ´i trÆ°á»ng há»‡ Ä‘iá»u hÃ nh Alpine Linux nhÃ©
Tiáº¿p theo trong file Dockerfile ta cÃ³ WORKDIR: Ã½ lÃ  ta sáº½ chuyá»ƒn Ä‘áº¿n Ä‘Æ°á»ng dáº«n lÃ  /app bÃªn trong Image, náº¿u Ä‘Æ°á»ng dáº«n nÃ y khÃ´ng tá»“n táº¡i thÃ¬ sáº½ tá»± Ä‘á»™ng Ä‘Æ°á»£c táº¡o luÃ´n nhÃ©
Tiáº¿p theo ta COPY toÃ n bá»™ file tá»« folder á»Ÿ mÃ´i trÆ°á»ng gá»‘c (bÃªn ngoÃ i - folder docker-python) vÃ  Ä‘Æ°a vÃ o trong Ä‘Æ°á»ng dáº«n /app bÃªn trong Image
Tiáº¿p tá»›i lÃ  ta cÃ i Ä‘áº·t dependencies, cáº§n cÃ i nhá»¯ng thá»© gÃ¬ thÃ¬ ta Ä‘á» cáº­p sáºµn á»Ÿ file requirements.txt rá»“i (cÃ¢u lá»‡nh nÃ y cÃ¡c báº¡n cÃ³ thá»ƒ xem nÃ³ xÃªm xÃªm nhÆ° npm install trong NodeJS nhÃ©)
Cuá»‘i cÃ¹ng lÃ  ta dÃ¹ng CMD Ä‘á»ƒ chá»‰ command máº·c Ä‘á»‹nh khi má»™t container Ä‘Æ°á»£c khá»Ÿi táº¡o tá»« Image: á»Ÿ Ä‘Ã¢y ta sáº½ khá»Ÿi Ä‘á»™ng file app.py
Build Docker Image
Sau khi cáº¥u hÃ¬nh nhiá»…n nháº·n ngon rá»“i, bÆ°á»›c tiáº¿p theo lÃ  ta build Image thÃ´i. CÃ¡c báº¡n cháº¡y command sau Ä‘á»ƒ build Image nhÃ©:
docker build -t learning-docker/python:v1 .
á» bÃ i trÆ°á»›c mÃ¬nh Ä‘Ã£ giáº£i thÃ­ch cho cÃ¡c báº¡n command trÃªn lÃ m gÃ¬ rá»“i, cÃ¡c báº¡n cÃ³ thá»ƒ xem láº¡i nhÃ©.
Giáº£i thÃ­ch nhanh: command trÃªn sáº½ build 1 image tÃªn lÃ  learning-docker/python vá»›i tag lÃ  v1, cáº£ tÃªn vÃ  tag ta Ä‘á»u cÃ³ thá»ƒ chá»n tÃ¹y Ã½, náº¿u ta khÃ´ng Ä‘á»ƒ tag thÃ¬ sáº½ tá»± Ä‘á»™ng Ä‘Æ°á»£c láº¥y lÃ  latest. Dáº¥u "cháº¥m" á»Ÿ cuá»‘i Ã½ báº£o Docker lÃ  "tÃ¬m file Dockerfile á»Ÿ thÆ° má»¥c hiá»‡n táº¡i vÃ  build" nhÃ©
Sau khi quÃ¡ trÃ¬nh build Image thÃ nh cÃ´ng, cÃ¡c báº¡n cÃ³ thá»ƒ kiá»ƒm tra báº±ng command:
docker images
Sáº½ tháº¥y hiá»ƒn thá»‹ nhÆ° sau nhÃ©:
Cháº¡y Project
Sau khi ta Ä‘Ã£ build thÃ nh cÃ´ng Image rá»“i thÃ¬ bÆ°á»›c tiáº¿p theo lÃ  cháº¡y project lÃªn vÃ  xem thÃ nh quáº£ thÃ´i nhÃ© .
Váº«n á»Ÿ folder docker-python, cÃ¡c báº¡n táº¡o file docker-compose.yml, vá»›i ná»™i dung nhÆ° sau:
version: "3.7"

services:
  app:
    image: learning-docker/python:v1
    ports:
      - "5000:5000"
    restart: unless-stopped
á» bÃ i trÆ°á»›c pháº§n cháº¡y project mÃ¬nh Ä‘Ã£ giáº£i thÃ­ch cho cÃ¡c báº¡n nhá»¯ng thá»© bÃªn trÃªn. Náº¿u cÃ¡c báº¡n chÆ°a Ä‘á»c thÃ¬ nÃªn xem qua nhÃ© .
Giáº£i thÃ­ch nhanh:
Ta Ä‘á»‹nh nghÄ©a 1 service tÃªn lÃ  app, service nÃ y khi cháº¡y sáº½ táº¡o ra 1 container tÆ°Æ¡ng á»©ng, container Ä‘Æ°á»£c táº¡o tá»« image vá»›i tÃªn chÃºng ta Ä‘Ã£ chá»n.
Ta map port tá»« cá»•ng 5000 á»Ÿ mÃ¡y gá»‘c (bÃªn ngoÃ i) vÃ o cá»•ng 5000 bÃªn trong container, vÃ¬ project cá»§a chÃºng ta Ä‘Æ°á»£c cháº¡y á»Ÿ cá»•ng 5000 (máº·c Ä‘á»‹nh cá»§a Flask)
Nom chá»«ng cÃ¡ch setup cháº£ khÃ¡c cho bÃ i trÆ°á»›c lÃ m vá»›i NodeJS lÃ  máº¥y nhá»‰ .
Äá»ƒ khá»Ÿi Ä‘á»™ng project cÃ¡c báº¡n cháº¡y command sau:
docker-compose up
Sau Ä‘Ã³ cÃ¡c báº¡n sáº½ tháº¥y á»Ÿ terminal hiá»ƒn thá»‹ nhÆ° sau
QuÃ¡ á»•n, test thá»­ thÃ´i nÃ o. CÃ¡c báº¡n má»Ÿ trÃ¬nh duyá»‡t á»Ÿ Ä‘á»‹a chá»‰ localhost:5000 nhÃ©.
VÃ  BÃ™M
KhÃ´ng cÃ³ gÃ¬ xáº£y ra
Thá»­ review láº¡i code xem nhÃ©:
File app.py khÃ¡ Ä‘Æ¡n giáº£n, khÃ´ng cÃ³ gÃ¬ Ä‘Ã¡ng gá»m
ÄÃ£ cÃ³ command cháº¡y app á»Ÿ file Dockerfile
Port cÅ©ng Ä‘Ã£ map á»Ÿ file docker-compose.yml
Tháº¿ váº¥n Ä‘á» lÃ  á»Ÿ Ä‘Ã¢u nhá»‰??
RÃµ rÃ ng náº¿u mÃ¬nh cháº¡y trá»±c tiáº¿p tá»« mÃ´i trÆ°á»ng ngoÃ i, mÃ¡y gá»‘c cá»§a mÃ¬nh (náº¿u á»Ÿ mÃ¡y gá»‘c cÃ¡c báº¡n cÃ³ cÃ i Python), khÃ´ng dÃ¹ng Docker ná»¯a, thÃ¬ má»i thá»© váº«n oke mÃ  nhá»‰...
Thá»­ review láº¡i docs cá»§a Flask á»Ÿ Ä‘Ã¢y, vÃ  ta Ä‘Ã£ tÃ¬m ra chÃ¢n lÃ½, chÃºng ta Ä‘á»ƒ Ã½ má»¥c Externally Visible Server. MÃ¬nh sáº½ dá»‹ch luÃ´n cho cÃ¡c báº¡n:
Náº¿u báº¡n cháº¡y á»©ng dá»¥ng lÃªn thÃ¬ báº¡n sáº½ Ä‘á»ƒ Ã½ tháº¥y ráº±ng á»©ng dá»¥ng cá»§a báº¡n chá»‰ cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c trong pháº¡m vi mÃ¡y cá»§a báº¡n (localhost), Ä‘iá»u nÃ y Ä‘Æ°á»£c cÃ i Ä‘áº·t máº·c Ä‘á»‹nh
Do Ä‘Ã³ khi cháº¡y project cá»§a chÃºng ta trong container thÃ¬ chá»‰ mÃ´i trÆ°á»ng trong container má»›i truy cáº­p Ä‘Æ°á»£c vÃ o project, project cá»§a chÃºng ta coi mÃ´i trÆ°á»ng Ä‘Ã³ má»›i lÃ  localhost, cÃ²n tá»« mÃ´i trÆ°á»ng gá»‘c (bÃªn ngoÃ i) truy váº¥n thÃ¬ sáº½ khÃ´ng Ä‘Æ°á»£c gá»i lÃ  localhost ná»¯a.
Note: cÃ¡c báº¡n chÃº Ã½ Ä‘iá»u nÃ y vÃ¬ sau nÃ y khi dockerize project Nuxt cÅ©ng sáº½ bá»‹ tÆ°Æ¡ng tá»±
Do Ä‘Ã³ Ä‘á»ƒ fix Ä‘iá»u nÃ y ta lÃ m nhÆ° sau.
CÃ¡c báº¡n sá»­a láº¡i file app.py má»™t chÃºt nhÆ° sau nhÃ©:
from flask import Flask, render_template

app = Flask(__name__)

@app.route("/")
def hello():
    return render_template('index.html', title='Docker Python', name='James')

if __name__ == "__main__":
    app.run(host="0.0.0.0")
á» trÃªn ta chá»‰ thÃªm vÃ o duy nháº¥t host=0.0.0.0 Ä‘á»ƒ nÃ³i vá»›i project chÃºng ta lÃ  "cháº¥p nháº­n cho táº¥t cáº£ má»i IP truy cáº­p"
á»”n rá»“i Ä‘Ã³ chÃºng ta build láº¡i image nhÃ©:
docker build -t learning-docker/python:v1 .
Sau khi build xong thÃ¬ ta cáº§n khá»Ÿi Ä‘á»™ng láº¡i project nhÃ©, cÃ¡c báº¡n cháº¡y command sau:
docker-compose down
docker-compose up
VÃ  cuá»‘i cÃ¹ng lÃ  má»Ÿ trÃ¬nh duyá»‡t vÃ  test thÃ´i nÃ o:
Tuyá»‡t vá»i
Biáº¿n mÃ´i trÆ°á»ng (ENV)
BÃ i trÆ°á»›c vÃ  bÃ i cÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y lÃ  project khi cháº¡y Ä‘á»u Ä‘Æ°á»£c fix cá»©ng 1 cá»•ng (bÃ i trÆ°á»›c lÃ  3000, bÃ i nÃ y lÃ  5000), tháº¿ náº¿u ta muá»‘n container cháº¡y á»Ÿ má»™t cá»•ng khÃ¡c thÃ¬ ta láº¡i pháº£i sá»­a code hay sao??
LÃºc Ä‘Ã³ ta sáº½ nghÄ© tá»›i biáº¿n mÃ´i trÆ°á»ng (environment variable), trong quÃ¡ trÃ¬nh dev vÃ  khi cháº¡y tháº­t táº¿ sá»­ dá»¥ng biáº¿n mÃ´i trÆ°á»ng sáº½ giÃºp ta ráº¥t nhiá»u trong viá»‡c giáº£m tá»‘i thiá»ƒu viá»‡c pháº£i sá»­a code
Biáº¿n mÃ´i trÆ°á»ng á»Ÿ Dockerfile
Äáº§u tiÃªn lÃ  ta sáº½ thá»­ dÃ¹ng biáº¿n mÃ´i trÆ°á»ng khai bÃ¡o á»Ÿ Dockerfile Ä‘á»ƒ thiáº¿t láº­p Port(cá»•ng) cho project cháº¡y trong container nhÃ© (Ã½ lÃ  container sáº½ khÃ´ng cháº¡y á»Ÿ port 5000 ná»¯a)
á» file app.py ta sá»­a láº¡i nhÆ° sau:
from flask import Flask, render_template
import os

app = Flask(__name__)

@app.route("/")
def hello():
    return render_template('index.html', title='Docker Python', name='James')

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=os.environ['PORT']) # Cháº¡y project á»Ÿ PORT nháº­n vÃ o tá»« biáº¿n mÃ´i trÆ°á»ng
Sau Ä‘Ã³ á»Ÿ file Dockerfile ta sá»­a láº¡i nhÆ° sau:
FROM python:3.6-alpine

WORKDIR /app

# Táº¡o ra biáº¿n mÃ´i trÆ°á»ng tÃªn lÃ  PORT vá»›i giÃ¡ trá»‹ 5555
ENV PORT 5555

COPY . .

RUN pip install -r requirements.txt

CMD ["python", "app.py"]
á» file docker-compose.yml ta sá»­a láº¡i chÃºt nhÆ° sau nhÃ©:
version: "3.7"

services:
  app:
    image: learning-docker/python:v1
    ports:
      - "5000:5555"
    restart: unless-stopped
CÃ¡c báº¡n Ä‘á»ƒ Ã½ á»Ÿ trÃªn khi ta map port ta chá»‰ chuyá»ƒn má»—i váº¿ bÃªn pháº£i, váº¿ bÃªn pháº£i lÃ  port cá»§a project cháº¡y á»Ÿ trong container nhÃ©, váº¿ bÃªn trÃ¡i lÃ  port á»Ÿ mÃ´i trÆ°á»ng gá»‘c (bÃªn ngoÃ i, ta cÃ³ thá»ƒ chá»n tÃ¹y Ã½, vÃ  Ä‘Ã¢y, port 5000 chÃ­nh lÃ  port mÃ  user sáº½ dÃ¹ng Ä‘á»ƒ truy cáº­p á»Ÿ trÃ¬nh duyá»‡t)
Tiáº¿p theo ta tiáº¿n hÃ nh build láº¡i image nhÃ©:
docker build -t learning-docker/python:v1 .
VÃ  khá»Ÿi Ä‘á»™ng láº¡i project:
docker-compose down
docker-compose up
Má»Ÿ trÃ¬nh duyá»‡t á»Ÿ Ä‘á»‹a chá»‰ localhost:5000 (váº«n nhÆ° cÅ©), cÃ¡c báº¡n sáº½ tháº¥y má»i thá»© cháº¡y bÃ¬nh thÆ°á»ng, nhÆ°ng ngÃ³ qua Terminal thÃ¬ sáº½ tháº¥y nhÆ° sau:
á» hÃ¬nh trÃªn ta tháº¥y ráº±ng á»Ÿ bÃªn trong container, project cá»§a chÃºng ta Ä‘Ã£ Ä‘Æ°á»£c cháº¡y á»Ÿ port 5555 rá»“i nhÃ©
Tháº¿ náº¿u bÃ¢y giá» ta muá»‘n Ä‘á»•i port cá»§a project trong container thÃ nh 6666 thÃ¬ sao, ta láº¡i pháº£i build láº¡i Image?
Vá»›i nhá»¯ng dáº¡ng biáº¿n mÃ´i trÆ°á»ng mÃ  dá»… thay Ä‘á»•i thÃ¬ ta cÃ³ sá»± lá»±a chá»n khÃ¡c Ä‘Æ¡n giáº£n hÆ¡n Ä‘Ã³ lÃ  khai bÃ¡o á»Ÿ file docker-compose.yml nhÃ©
Biáº¿n mÃ´i trÆ°á»ng á»Ÿ docker-compose
Äá»ƒ khÃ´ng pháº£i build láº¡i image má»—i láº§n ta Ä‘á»•i port, ta sáº½ khai bÃ¡o biáº¿n mÃ´i trÆ°á»ng á»Ÿ docker-compose.yml nhÃ©. Táº¡i sao:
Biáº¿n mÃ´i trÆ°á»ng á»Ÿ file Dockerfile sáº½ Ä‘Æ°á»£c khai bÃ¡o khi ta build image
Biáº¿n mÃ´i trÆ°á»ng á»Ÿ file docker-compose.yml sáº½ Ä‘Æ°á»£c khá»Ÿi táº¡o khi container Ä‘Æ°á»£c khá»Ÿi táº¡o, tá»©c lÃ  khi ta cháº¡y docker-compose up. Do Ä‘Ã³ Ä‘á»ƒ thay Ä‘á»•i biáº¿n mÃ´i trÆ°á»ng ta chá»‰ cáº§n down vÃ  up lÃ  xong
Thá»­ nghiá»‡m thÃ´i nÃ o...
á» file Dockerfile ta xÃ³a dÃ²ng ENV PORT 5555 Ä‘i nhÃ©.
Sau Ä‘Ã³ á»Ÿ file docker-compose.yml ta sá»­a láº¡i nhÆ° sau:
version: "3.7"

services:
  app:
    image: learning-docker/python:v1
    ports:
      - "5000:6666"
    restart: unless-stopped
    environment:
      PORT: 6666
BÃ¢y giá» ta váº«n cáº§n build láº¡i image 1 láº§n Ä‘á»ƒ cáº­p nháº­t má»›i Ä‘Æ°á»£c Ã¡p dá»¥ng:
docker build -t learning-docker/python:v1 .
Sau Ä‘Ã³ ta khá»Ÿi Ä‘á»™ng láº¡i project nhÃ©:
docker-compose down
docker-compose up
Sau Ä‘Ã³ F5 láº¡i trÃ¬nh duyá»‡t Ä‘á»ƒ cháº¯c cháº¯n má»i thá»© váº«n á»•n, vÃ  xem á»Ÿ terminal:
Váº­y lÃ  ta Ä‘Ã£ cÃ³ thá»ƒ dá»… dÃ ng thay Ä‘á»•i cá»•ng cá»§a project trong container khi dÃ¹ng biáº¿n mÃ´i trÆ°á»ng rá»“i. CÃ¡c báº¡n thá»­ Ä‘á»•i láº¡i thÃ nh 7777 thá»­ xem (nhá»› down vÃ  up docker-compose nhÃ© )
CÃ¡ch tá»‘t hÆ¡n Ä‘á»ƒ táº¡o biáº¿n mÃ´i trÆ°á»ng
á» vÃ­ dá»¥ trÃªn náº¿u ta muá»‘n Ä‘á»•i PORT thÃ nh 7777 cháº³ng háº¡n, ta pháº£i sá»­a á»Ÿ 2 nÆ¡i trong file docker-compose.yml, váº­y náº¿u biáº¿n Ä‘Ã³ dÃ¹ng á»Ÿ 100 nÆ¡i trong file docker-compose.yml thÃ¬ sao?
docker-compose support ta má»™t cÃ¡ch Ä‘Æ¡n giáº£n hÆ¡n, tiá»‡n hÆ¡n Ä‘á»ƒ khá»Ÿi táº¡o biáº¿n mÃ´i trÆ°á»ng, Ä‘Ã³ lÃ  Ä‘áº·t á»Ÿ file .env (giá»‘ng y nhÆ° Laravel , cÅ©ng Ä‘á»“ng nghÄ©a vá»›i viá»‡c náº¿u ta dockerize project Laravel thÃ¬ ta chá»‰ cáº§n duy nháº¥t 1 file chung lÃ  .env). Khi cháº¡y project thÃ¬ docker-compose sáº½ tá»± tÃ¬m xem cÃ³ file .env hay khÃ´ng vÃ  load cÃ¡c biáº¿n trong Ä‘Ã³.
CÃ¹ng thá»­ nhÃ©
á» folder docker-python ta táº¡o file .env vá»›i nÃ´i dung nhÆ° sau:
PORT=8888
PUBLIC_PORT=9999
Giáº£i thÃ­ch:
biáº¿n PORT: chá»‰ port cá»§a project cháº¡y bÃªn trong container
biáº¿n PUBLIC_PORT: chá»‰ port mÃ  "tháº¿ giá»›i bÃªn ngoÃ i" dÃ¹ng Ä‘á»ƒ truy cáº­p vÃ o project (Ã½ lÃ  port ta gá»i á»Ÿ trÃ¬nh duyá»‡t)
Ta sá»­a láº¡i file docker-compose.yml nhÆ° sau:
version: "3.4"

services:
  app:
    image: learning-docker/python:v1
    ports:
      - "${PUBLIC_PORT}:${PORT}"
    restart: unless-stopped
    environment:
      PORT: ${PORT}
Sau Ä‘Ã³ ta khá»Ÿi Ä‘á»™ng láº¡i project nhÃ©:
docker-compose down
docker-compose up
Check á»Ÿ terminal ta sáº½ tháº¥y:
Tuyá»‡t vá»i, project Ä‘Ã£ cháº¡y thÃ nh cÃ´ng á»Ÿ cá»•ng 8888 trong container. Giá» check trÃªn trÃ¬nh duyá»‡t thÃ´i nÃ o.
Ta má»Ÿ trÃ¬nh duyá»‡t á»Ÿ Ä‘á»‹a chá»‰ localhost:xxxx (cÃ¡c báº¡n tá»± Ä‘iá»n xxxx xem lÃ  gÃ¬ nhÃ© )
Push Image lÃªn registry
á» bÃ i trÆ°á»›c dÃ i quÃ¡ mÃ¬nh chÆ°a nÃ³i thÃªm vÃ o cÃ¡c Ä‘Æ°a image lÃªn registry vÃ  lÃ m ngÆ°á»i khÃ¡c cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c project cá»§a báº¡n tá»« image nhÆ° tháº¿ nÃ o. á» bÃ i nÃ y thÃ¬ ta cÃ³ Ä‘áº¥t diá»…n rá»“i
Docker build cháº¡y ngon ngháº» á»Ÿ mÃ¡y cá»§a ta rá»“i thÃ¬ thá»­ Ä‘Æ°a cho ngÆ°á»i khÃ¡c xem há» cháº¡y tháº¿ nÃ o chá»© nhá»‰
registry lÃ  nÆ¡i ta lÆ°u Docker image (giá»‘ng nhÆ° github Ä‘á»ƒ lÆ°u code, nhÆ°ng Ä‘Ã¢y lÃ  lÆ°u Docker image), cÃ³ ráº¥t nhiá»u registry, cÃ³ public cÃ³ private.
á» trong series nÃ y ta sáº½ dÃ¹ng Gitlab Ä‘á»ƒ lÆ°u code vÃ  cáº£ lÆ°u image trÃªn registry cá»§a há» nhÃ©. Gitlab cho ta unlimited image á»Ÿ private registry cho tá»«ng repository (quÃ¡ tuyá»‡t vá»i mÃ  cÃ²n free láº¡i cÃ²n private)
Táº¡o account vÃ  repository trÃªn Gitlab
Äáº§u tiÃªn cÃ¡c báº¡n cáº§n táº¡o 1 tÃ i khoáº£n trÃªn Gitlab.com (náº¿u chÆ°a cÃ³). Sau Ä‘Ã³ ta táº¡o má»™t repository tÃªn lÃ  learning-docker cho toÃ n bá»™ series nÃ y nhÃ©
Sau Ä‘Ã³ click chá»n repository ta vá»«a táº¡o, Ä‘á»ƒ Ã½ á»Ÿ pháº§n sidebar bÃªn tay trÃ¡i, hover chuá»™t vÃ o Packages, sau Ä‘Ã³ click chá»n Container Registry, Ä‘Ã¢y chÃ­nh lÃ  nÆ¡i ta sáº½ dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ image nhÃ©
CÃ¡c báº¡n sáº½ tháº¥y hiá»ƒn thá»‹ nhÆ° sau:
Báº¯t Ä‘áº§u
Giá» ta sáº½ cÃ¹ng thá»±c hÃ nh Ä‘áº©y image registry cá»§a gitlab nha
Äáº§u tiÃªn nhÆ° á»Ÿ hÃ¬nh trÃªn, ta cáº§n login vÃ o registry cá»§a Gitlab trÆ°á»›c (vÃ¬ registry nÃ y lÃ  private mÃ  ). Ta cháº¡y command sau Ä‘á»ƒ login:
docker login registry.gitlab.com
Ta sáº½ tháº¥y á»Ÿ terminal há»i email vÃ  password tÃ i khoáº£n gitlab, cÃ¡c báº¡n nháº­p thÃ´ng sá»‘ cá»§a cÃ¡c báº¡n vÃ o nhÃ©.
Sau Ä‘Ã³ bÆ°á»›c tiáº¿p theo nhÆ° á»Ÿ hÃ¬nh trÃªn ta cáº§n build image. NhÆ°ng vÃ¬ image ta Ä‘Ã£ cÃ³ sáºµn á»Ÿ local rá»“i nÃªn ta khÃ´ng cáº§n thiáº¿t build láº¡i ná»¯a.
"Ok váº­y lÃ  tÃ´i cÃ³ thá»ƒ Ä‘áº©y luÃ´n lÃªn Gitlab rá»“i áº¥y gÃ¬?" - ChÆ°a Äƒn ngay Ä‘Æ°á»£c Ä‘Ã¢u cÃ¡c báº¡n
Khi Ä‘áº©y image lÃªn registry cá»§a gitlab ta cáº§n pháº£i Ä‘áº·t tÃªn image theo chuáº©n cá»§a há», tag cÃ³ thá»ƒ Ä‘áº·t tÃ¹y Ã½ nhÆ°ng tÃªn pháº£i Ä‘Ãºng, theo format sau:
registry.gitlab.com/<username>/<tÃªn repo>
á» hÃ¬nh trÃªn cÃ¡c báº¡n copy paste cÃ¢u lá»‡nh docker push Ä‘á»ƒ xem báº¡n cáº§n pháº£i Ä‘áº·t tÃªn image tháº¿ nÃ o nhÃ©
Sau khi biáº¿t cáº§n Ä‘áº·t tÃªn nhÆ° nÃ o rá»“i thÃ¬ ta cÃ³ 2 lá»±a chá»n:
Build láº¡i image nhÆ° command thá»­ 2 á»Ÿ trong hÃ¬nh trÃªn Ä‘á»ƒ Ä‘Æ°á»£c image vá»›i tÃªn theo format
Äá»•i tÃªn Image hiá»‡n táº¡i Ä‘Ã£ cÃ³ á»Ÿ local
á» Ä‘Ã¢y mÃ¬nh sáº½ chá»n cÃ¡ch sá»‘ 2 lÃ  Ä‘á»•i tÃªn Ä‘á»ƒ ta khá»i pháº£i build láº¡i image nhÃ©
Ta cháº¡y command sau Ä‘á»ƒ liá»‡t kÃª danh sÃ¡ch image:
docker images
ta sáº½ tháº¥y nhÆ° sau:
Tiáº¿p theo ta sáº½ tiáº¿n hÃ nh cháº¡y command sau:
docker tag learning-docker/python:v1 registry.gitlab.com/maitrungduc1410/learning-docker
Note: pháº§n tÃªn image gitlab bÃªn trÃªn cÃ¡c báº¡n thay cho khá»›p vá»›i cá»§a báº¡n nhÃ©, Ä‘á»“ng thá»i náº¿u cÃ¡c báº¡n thá»­ liá»‡t kÃª danh sÃ¡ch image láº¡i sáº½ tháº¥y ta cÃ³ 1 image má»›i lÃ  báº£n sao cá»§a image cÅ©, image cÅ© váº«n cÃ²n Ä‘Ã³, cÃ¡c báº¡n cÃ³ thá»ƒ xÃ³a image cÅ© náº¿u cáº§n nhÃ©
Cuá»‘i cÃ¹ng lÃ  ta Ä‘áº©y image lÃªn registry thÃ´i nÃ o:
docker push registry.gitlab.com/maitrungduc1410/learning-docker  ## thay tÃªn image cho khá»›p vá»›i cá»§a cÃ¡c báº¡n nhÃ©
Sau khi upload thÃ nh cÃ´ng ta quay láº¡i trang Container Registry trÃªn gitlab vÃ  check:
CÃ¡c báº¡n cÃ³ thá»ƒ tháº¥y lÃ  ta Ä‘Ã£ cÃ³ 1 image trÃªn registry vá»›i tag lÃ  latest (vÃ¬ khi nÃ£y lÃºc Ä‘á»•i tÃªn vÃ  khi push ta khÃ´ng nÃ³i tag lÃ  gÃ¬ nÃªn docker máº·c Ä‘á»‹nh tag lÃ  latest)
Pull Image vá» vÃ  cháº¡y thá»­
Láº¡i Ä‘áº¿n giá» phÃºt cá»§a sá»± tháº­t, khÃ´ng biáº¿t khi Ä‘em image qua mÃ¡y khÃ¡c cháº¡y hoáº·c má»™t nÆ¡i nÃ o Ä‘Ã³ thÃ¬ má»i thá»© cÃ³ cÃ²n á»•n hay khÃ´ng??
BÃ¢y giá» cÃ¡c báº¡n sáº½ dÃ¹ng má»™t mÃ¡y khÃ¡c, hoáº·c náº¿u khÃ´ng cÃ³ thÃ¬ ta chuyá»ƒn qua má»™t folder nÃ o Ä‘Ã³ Ä‘á»ƒ test, náº¿u dÃ¹ng mÃ¡y khÃ¡c thÃ¬ nhá»› lÃ  mÃ¡y Ä‘Ã³ pháº£i cÃ i Docker vÃ  Docker compose nhÃ©.
Ta táº¡o má»™t folder test lÃ  test-docker á»Ÿ báº¥t kÃ¬ Ä‘Ã¢u báº¡n muá»‘n. Trong Ä‘Ã³ ta cÃ³ cÃ¡c file nhÆ° sau:
.env Ä‘á»ƒ táº¡o biáº¿n mÃ´i trÆ°á»ng
docker-compose.yml Ä‘á»ƒ khá»Ÿi cháº¡y project
File .env ta giá»¯ nguyÃªn ná»™i dung, nhÆ°ng file docker-compose.yml ta sá»­a láº¡i nhÆ° sau:
version: "3.4"

services:
  app:
    # Ä‘á»•i tÃªn image á»Ÿ Ä‘Ã¢y cho Ä‘Ãºng vá»›i cá»§a báº¡n (khÃ´ng nÃ³i gÃ¬ vá» tag thÃ¬ máº·c Ä‘á»‹nh lÃ  'latest')
    image: registry.gitlab.com/maitrungduc1410/learning-docker 
    ports:
      - "${PUBLIC_PORT}:${PORT}"
    restart: unless-stopped
    environment:
      PORT: ${PORT}
Sau Ä‘Ã³ ta láº¡i chá»‰ cáº§n cháº¡y command sau Ä‘á»ƒ khá»Ÿi Ä‘á»™ng project:
docker-compose up
VÃ¬ image ta Ä‘á»ƒ lÃ  á»Ÿ trÃªn má»™t private gitlab chá»‰ cÃ³ ta má»›i Ä‘Æ°á»£c láº¥y image vá», nÃªn do Ä‘Ã³ náº¿u tháº¥y bÃ¡o lá»—i xÃ¡c thá»±c thÃ¬ cÃ¡c báº¡n cháº¡y láº¡i command sau Ä‘á»ƒ login nhÃ©:
docker login registry.gitlab.com
# Cháº¡y xong ta láº¡i docker-compose up lÃ  Ä‘Æ°á»£c nhÃ©
VÃ  má»i thá»© sáº½ cháº¡y nhÆ° bÃ¬nh thÆ°á»ng , ta sáº½ cÃ³ káº¿t quáº£ há»‡t nhÆ° á»Ÿ mÃ¡y gá»‘c cá»§a chÃºng ta, dÃ¹ ta Ä‘Æ°a image Ä‘i cháº¡y á»Ÿ mÃ¡y nÃ o cÅ©ng váº­y.
Káº¿t bÃ i
MÃ¬nh biáº¿t lÃ  bÃ i nÃ y láº¡i lÃ m cho cÃ¡c báº¡n Ä‘au máº¯t vÃ¬ Ä‘á»™ dÃ i, vÃ¬ cÃ³ nhiá»u thá»© mÃ¬nh muá»‘n nÃ³i tá»›i, nhÆ°ng dáº§n dáº§n nhá»¯ng khÃ¡i niá»‡m má»›i sáº½ háº¿t vÃ  ta sáº½ táº­p trung nhiá»u vÃ o viá»‡c thá»±c hÃ nh hÆ¡n nhÃ©, sá»± Ä‘au máº¯t mÃ¬nh hi vá»ng vÃ¬ tháº¿ cÅ©ng giáº£m Ä‘i
Qua bÃ i nÃ y cÃ¡c báº¡n Ä‘Ã£ tháº¥y Ä‘Æ°á»£c cÃ¡ch Ä‘á»ƒ dockerize má»™t á»©ng dá»¥ng Python nhÆ° nÃ o, khÃ¡ giá»‘ng bÃ i trÆ°á»›c cho NodeJS pháº£i khÃ´ng . Ta váº«n khÃ´ng cáº§n pháº£i cÃ i trá»±c tiáº¿p Python vÃ o mÃ´i trÆ°á»ng gá»‘c (bÃªn ngoÃ i), váº«n chá»‰ cÃ³ duy nháº¥t docker vÃ  docker-compose
á» bÃ i nÃ y cÃ³ 2 ná»™i dung quan trá»ng mÃ¬nh muá»‘n nÃ³i tá»›i:
CÃ¡ch dÃ¹ng biáº¿n mÃ´i trÆ°á»ng
CÃ¡ch Ä‘Æ°a image lÃªn registry Ä‘á»ƒ sau nÃ y ta cÃ³ thá»ƒ táº£i vá» vÃ  cÃ¡ch táº£i xuá»‘ng image Ä‘á»ƒ cháº¡y nhÆ° tháº¿ nÃ o
CÃ¡m Æ¡n cÃ¡c báº¡n Ä‘Ã£ theo dÃµi, náº¿u cÃ³ gÃ¬ tháº¯c máº¯c cÃ¡c báº¡n cá»© comment bÃªn dÆ°á»›i cho mÃ¬nh Ä‘Æ°á»£c biáº¿t nhÃ© .
Source code bÃ i nÃ y mÃ¬nh Ä‘á»ƒ á»Ÿ Ä‘Ã¢y (nhÃ¡nh complete-tutorial nhÃ©)
Háº¹n gáº·p láº¡i cÃ¡c báº¡n á»Ÿ cÃ¡c bÃ i sau ^^
Docker
Python
Flask

All rights reserved
Má»¤C Lá»¤C
Tiá»n Setup
Setup
Build Docker Image
Cáº¥u hÃ¬nh Dockerfile
Build Docker Image
Cháº¡y Project
Biáº¿n mÃ´i trÆ°á»ng (ENV)
Biáº¿n mÃ´i trÆ°á»ng á»Ÿ Dockerfile
Biáº¿n mÃ´i trÆ°á»ng á»Ÿ docker-compose
CÃ¡ch tá»‘t hÆ¡n Ä‘á»ƒ táº¡o biáº¿n mÃ´i trÆ°á»ng
Push Image lÃªn registry
Táº¡o account vÃ  repository trÃªn Gitlab
Báº¯t Ä‘áº§u
Pull Image vá» vÃ  cháº¡y thá»­
Káº¿t bÃ i
BÃ€I VIáº¾T THUá»˜C SERIES
[Series] Há»c Docker, CICD tá»« cÆ¡ báº£n Ä‘áº¿n Ã¡p dá»¥ng vÃ o thá»±c táº¿
1. LÃ­ do tÃ´i yÃªu Docker
2. Dockerize á»©ng dá»¥ng NodeJS
3. Dockerize á»©ng dá»¥ng Python, Flask
4. Dockerize á»©ng dá»¥ng VueJS, ReactJS
5. Dockerize á»©ng dá»¥ng Laravel
6. Dockerize Project NodeJS, MongoDB, Redis, Passport
7. Dockerize á»©ng dá»¥ng chat realtime vá»›i Laravel, Nginx, VueJS, Laravel Echo, Redis, SocketIO
8. Giá»›i thiá»‡u Docker Network vÃ  HEALTHCHECK - 2 cÃ´ng cá»¥ há»¯u Ã­ch tá»« Docker
9. Báº£o máº­t á»©ng dá»¥ng Docker NodeJS, Mongo, Redis
10. Nháº­p mÃ´n CICD vá»›i Gitlab
11. Automation Test vá»›i Docker vÃ  Gitlab CI











BÃ i viáº¿t liÃªn quan
CÃ¡ch dÃ¹ng Docker Ä‘á»ƒ phÃ¡t triá»ƒn á»©ng dá»¥ng Wordpress
Nguyá»…n Há»¯u Kim
4 phÃºt Ä‘á»c
2.5K
14
2
26
Tá»± xÃ¢y dá»±ng cho mÃ¬nh á»©ng dá»¥ng trÃªn docker
DÆ°Æ¡ng Pháº¡m
7 phÃºt Ä‘á»c
14.5K
13
2
12
XÃ¢y dá»±ng API Ä‘Æ¡n giáº£n vá»›i Flask, demo vá»›i Ngrok
Nguyá»…n Nam Anh
5 phÃºt Ä‘á»c
1.7K
6
2
3
XÃ¢y dá»±ng backend Flask, Nginx, Uwsgi trong docker nhÆ° tháº¿ nÃ o cho nhanh
WheeBoo
2 phÃºt Ä‘á»c
2.4K
5
0
5
BÃ i viáº¿t khÃ¡c tá»« Mai Trung Äá»©c
Táº¡o vÃ  sá»­ dá»¥ng PersistentVolume vÃ  PersistentVolumeClaim trong Kubernetes
Mai Trung Äá»©c
33 phÃºt Ä‘á»c
484
1
9
14
Microfrontend, Module Federation - Ä‘Æ°a microservices Ä‘áº¿n vá»›i frontend
Mai Trung Äá»©c
27 phÃºt Ä‘á»c
4.0K
32
25
68
Deploy Github Self Host Runner vá»›i Docker Compose dÃ¹ng Replicated Mode
Mai Trung Äá»©c
24 phÃºt Ä‘á»c
1.9K
6
0
23
LÃ m viá»‡c vá»›i Configmap vÃ  Secret trÃªn Kubernetes
Mai Trung Äá»©c
24 phÃºt Ä‘á»c
1.4K
2
6
24
BÃ¬nh luáº­n
ÄÄƒng nháº­p Ä‘á»ƒ bÃ¬nh luáº­n
Tháº¿ Vinh @jinvauser
thg 12 22, 2019 8:27 CH
Ráº¥t chi tiáº¿t vÃ  dá»… hiá»ƒu.. pháº£i login vote cho báº¡n
+1
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 12 22, 2019 9:59 CH
cÃ¡m Æ¡n báº¡n Ä‘Ã£ theo dÃµi nhÃ©
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 12 22, 2019 9:59 CH
BÃ¬nh luáº­n nÃ y Ä‘Ã£ bá»‹ xÃ³a
Chu Há»“ TÃ¢y @chuhotay1999
thg 12 27, 2019 10:13 SA
BÃ i viáº¿t cá»±c kÃ¬ dá»… hiá»ƒu. Step by step rÃµ rÃ ng. Báº¡n cá»‘ gáº¯ng ra thÃªm nhiá»u bÃ i ná»¯a nhÃ©. ChÃºc báº¡n luÃ´n thÃ nh cÃ´ng
+1
|
Tráº£ lá»i
Chia sáº»
Huy Nguyá»…n @huy_nguyen
thg 12 29, 2019 12:57 SA
Dear Äá»©c,
Báº¡n giÃºp mÃ¬nh clear chá»— táº¡o file .env nhÃ©. MÃ¬nh táº¡o xong cháº¡y trÃªn public port = 9999 vÃ  private port = 8888. NhÆ°ng khi up lÃªn thÃ¬ mÃ¬nh tháº¥y váº«n cháº¡y port 5000.
MÃ¬nh khÃ´ng tháº¥y chá»— nÃ o cÃ³ cáº¥u hÃ¬nh mÃ³c .env vÃ o háº¿t ( Dockerfile vÃ  docker-compose.yml)
P/s MÃ¬nh mÃ² máº«m má»›i bÆ°á»›c vÃ o docker, mong báº¡n thÃ´ng cáº£m nhÃ©.
Cáº£m Æ¡n Äá»©c.
0
|
Tráº£ lá»i
Chia sáº»
Xem thÃªm (4)
Mai Trung Äá»©c @maitrungduc1410
thg 12 29, 2019 11:35 SA
CÃ¡m Æ¡n Huy Ä‘Ã£ chia sáº» nhÃ©
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 12 29, 2019 11:35 SA
BÃ¬nh luáº­n nÃ y Ä‘Ã£ bá»‹ xÃ³a
Yen Devy @yendevy
thg 1 16, 2020 11:14 SA
https://prnt.sc/qocdc7 anh Æ¡i update doc Ä‘i anh )
+1
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 1 16, 2020 1:41 CH
cÃ¡m Æ¡n e nhÃ©, a Ä‘Ã£ update láº¡i Ä‘oáº¡n Ä‘Ã³ nhÃ©
0
|
Tráº£ lá»i
Chia sáº»
Tr SÆ¡n @ssondaii
thg 6 10, 2020 1:16 CH
oáº³ng khi login vÃ o gitlab sau khi cháº¡y docker login registry.gitlab.com anh áº¡, nÃ³ ko cho nháº­p password ?????
0
|
Tráº£ lá»i
Chia sáº»
Xem thÃªm (2)
Mai Trung Äá»©c @maitrungduc1410
thg 6 10, 2020 11:19 CH
Auth trÃªn command line thÃ¬ password nÃ³ áº©n Ä‘i k hiá»‡n trÃªn mÃ n hÃ¬nh thÃ´i e, váº«n nháº­n Ä‘Ã³. Cá»© gÃµ vÃ o nhÃ©, rá»“i submit lÃ  Ä‘c
0
|
Tráº£ lá»i
Chia sáº»
Tr SÆ¡n @ssondaii
thg 6 11, 2020 10:52 SA
0
|
Tráº£ lá»i
Chia sáº»
Phong ÄoÃ n @pdoan
thg 8 22, 2020 10:43 SA
Series quÃ¡ hay, e pháº£i login Ä‘á»ƒ vote cho a.
A thÃ´ng há»™ e chá»— nÃ y vá»›i:
E lÃ m theo hÆ°á»›ng dáº«n cá»§a a, dockerize cho 1 project Python cÃ³ sáºµn, Ä‘áº¿n bÆ°á»›c nÃ y:
docker build -t learning-docker/python:v1 .
ThÃ¬ nÃ³ cháº¡y Ä‘áº¿n bÆ°á»›c Step 5/6 : RUN pip install -r requirements.txt
ThÃ¬ bá»‹ lá»—i:
ERROR: Could not find a version that satisfies the requirement tensorflow>=1.12.0 (from -r requirements.txt (line 2)) (from versions: none) ERROR: No matching distribution found for tensorflow>=1.12.0 (from -r requirements.txt (line 2)).
KhÃ´ng tÃ¬m tháº¥y version cá»§a tensorflow.
BÃ¬nh thÆ°á»ng náº¿u cháº¡y code python ko dÃ¹ng docker thÃ¬ e sáº½ cháº¡y pip install....
NhÆ°ng á»Ÿ Ä‘Ã¢y n cháº¡y dc Ä‘áº¿n bÆ°á»›c 5/6. NÃªn image n cá»© bá»‹ restart láº¡i liÃªn tá»¥c, nÃªn ko cháº¡y dc docker-compose up Ä‘á»ƒ cháº¡y pip install....
A cho e há»i lÃ m cÃ¡ch nÃ o Ä‘á» fix dc lá»—i nÃ y áº¡.
0
|
Tráº£ lá»i
Chia sáº»
Xem thÃªm (4)
Mai Trung Äá»©c @maitrungduc1410
thg 8 22, 2020 4:50 CH
e docker-compose down sau Ä‘Ã³ build láº¡i image rá»“i docker-compose up.
hoáº·c chui trá»±c tiáº¿p vÃ o container Ä‘á»ƒ cÃ i, nhÆ°ng nhÆ° tháº¿ khÃ´ng hay vÃ¬ khi e down Ä‘i sáº½ bá»‹ máº¥t
0
|
Tráº£ lá»i
Chia sáº»
Phong ÄoÃ n @pdoan
thg 8 22, 2020 6:05 CH
tks a áº¡
+1
|
Tráº£ lá»i
Chia sáº»
Äá»©c Master @ducmaster
thg 10 10, 2020 5:58 CH
Dá»… hiá»ƒu quÃ¡ anh
+1
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 10 10, 2020 9:30 CH
0
|
Tráº£ lá»i
Chia sáº»
Nguyá»…n Thá»‹nh @nbthinh
thg 4 27, 2021 9:41 SA
MÃ  báº¡n Æ¡i, báº¡n cÃ³ cÃ¡i bÃ i nÃ o mÃ  Dockerzie app nodejs gá»i Python script Ä‘Æ°á»£c khÃ´ng báº¡n? Chá»© á»©ng dá»¥ng nodejs gá»i Python script mÃ  cÃ³ cÃ¡c thÆ° viÃªn sklearn, numpy khÃ´ng cháº¡y Ä‘Æ°á»£c khi up lÃªn heroku
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 4 27, 2021 11:04 SA
Ä‘Æ°á»£c báº¡n, thoáº£i mÃ¡i, mÃ¬nh Ä‘Ã£ tá»«ng lÃ m nhÆ° váº­y, 1 trong nhá»¯ng cÃ¡ch Ä‘Ã³ lÃ  báº¡n dÃ¹ng child_process cá»§a nodejs vÃ  spawn cÃ¡i python script cá»§a báº¡n
0
|
Tráº£ lá»i
Chia sáº»
Nguyá»…n Thá»‹nh @nbthinh
thg 4 27, 2021 11:24 SA
báº¡n cÃ³ bÃ i hÆ°á»›ng dáº«n Ä‘Ã³ share link cho mÃ¬nh Ä‘Æ°á»£c ko? bÃ i mÃ¬nh Ä‘ang lÃ m lÃ  dÃ¹ng nodejs calo Python script nhÆ°ng cháº¡y trÃªn localhost thÃ¬ Ä‘Æ°á»£c, nhÆ°ng Ä‘Æ°a lÃªn heroku thÃ¬ ko cháº¡y Ä‘Æ°á»£c.@maitrungduc1410
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 4 27, 2021 12:41 CH
@nbthinh mÃ¬nh ko cÃ³ bÃ i Ä‘Ã³ báº¡n, cÃ¡i Ä‘Ã³ lÃ  code Ä‘i lÃ m ngÃ y trÆ°á»›c. Báº¡n check á»Ÿ Ä‘Ã¢y: https://nodejs.org/api/child_process.html, cÅ©ng ko khÃ³ Ä‘Ã¢u
0
|
Tráº£ lá»i
Chia sáº»
Tuan @NguyenDucTuan92N1
thg 5 9, 2021 4:38 CH
BÃ i viáº¿t hay quÃ¡. cáº£m Æ¡n anh nhiá»u. Em cÃ³ chá»— khÃ´ng rÃµ mong Ä‘Æ°á»£c anh giáº£i Ä‘Ã¡p. Má»—i khi em chá»‰nh sá»­a code thÃ¬ láº¡i cáº§n pháº£i build láº¡i image Ä‘á»ƒ COPY code vÃ o trong image. Rá»“i sau Ä‘Ã³ má»›i docker-compose down, docker-compose up, Ä‘á»ƒ cháº¡y. KhÃ´ng biáº¿t lÃ  cÃ³ cÃ¡ch nÃ o cháº¡y nhanh vÃ  hiá»‡u quáº£ khÃ´ng anh nhá»‰.
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 5 10, 2021 10:41 SA
app Python á»Ÿ trong bÃ i lÃ  a Ä‘ang cháº¡y á»Ÿ production mode nÃªn má»—i láº§n e muá»‘n thay Ä‘á»•i thÃ¬ e pháº£i build láº¡i image, ká»ƒ cáº£ e cÃ³ mount source code bÃªn ngoÃ i vÃ o trong thÃ¬ cÅ©ng ko Ä‘c vÃ¬ nÃ³ ko reload má»—i khi e thay Ä‘á»•i. E update láº¡i nhÆ° sau lÃ  Ä‘Æ°á»£c nhÃ©:
version: "3.4"
services:
  app:
    image: learning-docker/python:v1
    ports:
      - "${PUBLIC_PORT}:${PORT}"
    restart: unless-stopped
    volumes:
      - ./:/app # ---> Mount source code tá»« ngoÃ i vÃ o trong Ä‘á»ƒ bÃªn ngoÃ i cáº­p nháº­t thÃ¬ code bÃªn trong container cÅ©ng cáº­p nháº­t theo
    environment:
      PORT: ${PORT}
      FLASK_DEBUG: 1 # ---> cháº¡y app á»Ÿ Debug mode, má»—i khi code bÃªn trong container thay Ä‘á»•i thÃ¬ sáº½ tá»± Ä‘á»™ng reload cáº­p nháº­t code má»›i
Sau Ä‘Ã³ e docker-compose down rá»“i up láº¡i lÃ  Ä‘Æ°á»£c
0
|
Tráº£ lá»i
Chia sáº»
Tuan @NguyenDucTuan92N1
thg 5 10, 2021 6:51 CH
@maitrungduc1410 cáº£m Æ¡n a Ä‘Ã£ chia sáº» áº¡. ChÃºc anh luÃ´n thÃ nh cÃ´ng trong cÃ´ng viá»‡c.
+1
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 5 11, 2021 10:52 SA
@NguyenDucTuan92N1 a cÅ©ng chÃºc e Ä‘iá»u tÆ°Æ¡ng tá»±, vÃ  nhiá»u hÆ¡n tháº¿
0
|
Tráº£ lá»i
Chia sáº»
Tuan @NguyenDucTuan92N1
thg 5 9, 2021 4:40 CH
Em cÃ³ tháº¯c máº¯c lÃ  má»—i khi em build láº¡i Image thÃ¬ láº¡i cÃ³ thÃªm 1 images má»›i, khÃ´ng biáº¿t cÃ¡i <none> áº¥y lÃ  áº£o hay nÃ³ sáº½ tá»± xÃ³a sau 1 thá»i gian áº¡.
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 5 10, 2021 9:04 SA
sau khi e build image má»›i vá»›i cÃ¹ng tag thÃ¬ image cÅ© vá»›i chÃ­nh tag Ä‘Ã³ sáº½ trá»Ÿ thÃ nh <none, nÃ³ sáº½ cá»© á»Ÿ Ä‘Ã³ náº¿u e ko xoÃ¡, e cÃ³ thá»ƒ xoÃ¡ nÃ³ báº±ng cÃ¡ch:
docker rmi <image ID>
0
|
Tráº£ lá»i
Chia sáº»
Nguyen Khac Thang @thangnk
thg 8 4, 2021 9:21 CH
A cho em há»i vá»›i áº¡ VÃ­ dá»¥ em Ä‘ang cáº§n cÃ i Keras, váº­y thÃ¬ em lÃ m tn Ä‘á»ƒ biáº¿t mÃ´i trÆ°á»ng python Ä‘ang dÃ¹ng cá»§a em cÃ³ support Keras áº¡
VÃ  cÃ²n nhiá»u module khÃ¡c ná»¯a áº¡ Hiá»‡n em Ä‘ang dÃ¹ng python:3.6-stretch mÃ  váº«n ko cÃ i Ä‘Æ°á»£c Keras áº¡
0
|
Tráº£ lá»i
Chia sáº»
Xem thÃªm (5)
Nguyen Khac Thang @thangnk
thg 8 6, 2021 9:08 CH
@maitrungduc1410 Em Ä‘ang thá»­ FROM continuumio/anaconda3 theo cáº¥u trÃºc arm64
CÃ³ láº§n Ä‘Æ°á»£c láº§n khÃ´ng, cÃ³ váº» chÆ°a Ä‘Æ°á»£c á»•n Ä‘á»‹nh a áº¡
Thanks a Ä‘Ã£ support e
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 8 6, 2021 10:39 CH
@thangnk okie e, chÃºc e may máº¯n
+1
|
Tráº£ lá»i
Chia sáº»
Sang Nguyá»…n tháº¿ @sangmeo
thg 8 12, 2021 5:47 CH
ngÆ°á»i Æ¡i accept em trÃªn facebook Ä‘Æ°á»£c khÃ´ng idol muá»‘n Ä‘Æ°á»£c bay sang sing nhÆ° anh :v
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 8 12, 2021 5:49 CH
FB cá»§a e lÃ  j Ä‘Ã³
0
|
Tráº£ lá»i
Chia sáº»
Sang Nguyá»…n tháº¿ @sangmeo
thg 8 12, 2021 5:54 CH
@maitrungduc1410 https://www.facebook.com/ITtodaynow idol Æ¡i accept em vá»›i
0
|
Tráº£ lá»i
Chia sáº»
Sang Nguyá»…n tháº¿ @sangmeo
thg 8 12, 2021 6:04 CH
@maitrungduc1410 náº¿u anh thÃ­ch thÃ¬ anh cÃ³ thá»ƒ lÃ m 1 series vá» NestJS anh áº¡. KKK em cÅ©ng Ä‘ang lÃ m vá» cÃ¡i nÃ y vÃ  nÃ³ cÅ©ng lÃ  1 framework ráº¥t tiá»m nÄƒng trong nhá»¯ng nÄƒm sáº¯p tá»›i
0
|
Tráº£ lá»i
Chia sáº»
Remix music HOT @binhloc25012015
thg 1 14, 2022 1:58 CH
Hi báº¡n tut ráº¥t hay vÃ  dá»… hiá»ƒu. Báº¡n cho mÃ¬nh há»i tÃ­ hiá»‡n mÃ¬nh log in vÃ o gitlab khÃ´ng Ä‘Æ°á»£c áº¡. docker login registry.gitlab.com Error: Error response from daemon: Get https://registry.gitlab.com/v2/: unauthorized: HTTP Basic: Access denied
search google tháº¥y pháº£i báº­t mode Container Registry trong repo gitlab nhÆ°ng repo mÃ¬nh khÃ´ng cÃ³ tab Ä‘Ã³. Cáº£m Æ¡n báº¡n
+1
|
Tráº£ lá»i
Chia sáº»
Remix music HOT @binhloc25012015
thg 1 14, 2022 2:40 CH
mÃ¬nh tÃ¬m ra lÃ­ do cÃ³ láº» do dÃ¹ng account cty nÃªn bá»‹ block chá»• Ä‘Ã³ thank báº¡n
+1
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 1 14, 2022 10:04 CH
@binhloc25012015 okie báº¡n Æ¡i
0
|
Tráº£ lá»i
Chia sáº»
Ngo Thanh Dong @DongNT
thg 4 28, 2022 10:13 SA
Náº¿u báº¡n nÃ o cháº¡y lá»‡nh docker login registry.gitlab.com bá»‹ lá»—i nhÆ° sau:
Error response from daemon: Get "https://registry.gitlab.com/v2/": unauthorized: HTTP Basic: Access denied
ThÃ¬ fix nhÆ° sau nhÃ©:
Táº¡o access token:
https://gitlab.com/-/profile/personal_access_tokens --> check api, read_registry
GÃµ lá»‡nh login theo cÃº phÃ¡p sau:
docker login registry.gitlab.com -u <your_username> -p <your_personal_access_token>
ChÃºc cÃ¡c báº¡n thÃ nh cÃ´ng
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 4 28, 2022 3:40 CH
cÃ¡m Æ¡n báº¡n nhÃ©
0
|
Tráº£ lá»i
Chia sáº»
TrÆ°á»ng ÄoÃ n @doantruong
thg 5 19, 9:03 SA
Hi a, Thanks a vá» series docker nÃ y. E cÃ³ má»™t chÃºt tháº¯c máº¯c nhá». Khi dockerize á»©ng dá»¥ng FE (react, vue) thÃ¬ sáº½ cÃ³ thÃªm 1 stage build nginx webserver Ä‘á»ƒ run web thay vÃ¬ npm run dev. NhÆ°ng á»Ÿ cÃ¡c á»©ng dá»¥ng BE (node, python) mÃ¬nh láº¡i run webser vá»›i host=0.0.0.0 (npm start/python app.py) Ä‘á»ƒ táº¡o 1 webserver á»Ÿ local vÃ  cho phÃ©p access tá»« ngoÃ i vÃ o chá»© khÃ´ng dÃ¹ng nginx giá»‘ng vá»›i FE. Anh cÃ³ thá»ƒ giáº£i thÃ­ch vÃ¬ sao Ä‘Æ°á»£c khÃ´ng áº¡? Thanks a nhiá»u
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 5 19, 9:26 SA
vá»›i cÃ¡c app frontend, sau khi build xong thÃ¬ ta Ä‘c cÃ¡c file static (HTML, CSS, JS), báº£n thÃ¢n chÃºng khÃ´ng tá»± cháº¡y Ä‘Æ°á»£c mÃ  cáº§n cÃ³ 1 server (webserver) Ä‘á»ƒ "serve" (phá»¥c vá»¥) nÃ³.E cÃ³ thá»ƒ dÃ¹ng NodeJS, Python, PHP, báº¥t kÃ¬ backend nÃ o cÅ©ng Ä‘Æ°á»£c, hoáº·c nhÆ° a thÃ¬ a thÃ­ch dÃ¹ng Nginx hÆ¡n
DÃ¹ng Nginx hay dÃ¹ng Python/Nodejs/php lÃ  tuá»³ e háº¿t nhÃ©, má»—i cÃ¡i Ä‘á»u cÃ³ tá»‘t/chÆ°a tá»‘t trong nhá»¯ng trÆ°á»ng há»£p khÃ¡c nhau, nhÆ°ng náº¿u chá»‰ Ä‘Æ¡n giáº£n lÃ  "serve" app React/Vue thÆ°á»ng thÃ¬ Nginx tá»‘t hÆ¡n vÃ¬ nÃ³ support nhiá»u thá»© cho static assets
0
|
Tráº£ lá»i
Chia sáº»
Pháº¡m Äá»©c KhÃ¡nh @duckhanh2411
thg 9 15, 12:04 CH
best tutorial ever, respect
+1
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 9 16, 11:22 SA
cÃ¡m Æ¡n báº¡n Ä‘Ã£ theo dÃµi
0
|
Tráº£ lá»i
Chia sáº»
Huynh @huynhttdev
thg 11 18, 10:32 SA
Anh cho e há»i chÃºt lÃ  giáº£ dá»¥ ngÆ°á»i khÃ¡c muá»‘n táº£i cÃ¡i cá»§a mÃ¬nh vá» thÃ¬ mÃ¬nh pháº£i Ä‘á»ƒ project lÃ  public Ä‘á»ƒ cho ngÆ°á»i kia dÃ¹ng bÃ¬nh thÆ°á»ng pháº£i khÃ´ng a?
0
|
Tráº£ lá»i
Chia sáº»
Mai Trung Äá»©c @maitrungduc1410
thg 11 20, 5:35 CH
Ä‘Ãºng rá»“i e, e muá»‘n ngÆ°á»i khÃ¡c dÃ¹ng Ä‘Æ°á»£c cÃ¡i cá»§a e thÃ¬ e sáº½ build project cá»§a e thÃ nh 1 cÃ¡i image vÃ  push lÃªn Ä‘Ã¢u Ä‘Ã³ Ä‘á»ƒ ngÆ°á»i ta cÃ³ thá»ƒ táº£i vá» Ä‘Æ°á»£c. vÃ­ dá»¥ docker hub: https://hub.docker.com
0
|
Tráº£ lá»i
Chia sáº»
TÃ€I NGUYÃŠN
BÃ i viáº¿t
Tá»• chá»©c
CÃ¢u há»i
Tags
Videos
TÃ¡c giáº£
Tháº£o luáº­n
Äá» xuáº¥t há»‡ thá»‘ng
CÃ´ng cá»¥
Machine Learning
Tráº¡ng thÃ¡i há»‡ thá»‘ng
Dá»ŠCH Vá»¤
Viblo
Viblo Code
Viblo CTF
Viblo CV
Viblo Learning
Viblo Partner
Viblo Battle
Viblo Interview
á»¨NG Dá»¤NG DI Äá»˜NG
LIÃŠN Káº¾T
Â© 2023 Viblo. All rights reserved.
Vá» chÃºng tÃ´i
Pháº£n há»“i
GiÃºp Ä‘á»¡
FAQs
RSS
Äiá»u khoáº£n
HÃ£y Ä‘Äƒng kÃ½ má»™t tÃ i khoáº£n Viblo Ä‘á»ƒ nháº­n Ä‘Æ°á»£c nhiá»u bÃ i viáº¿t thÃº vá»‹ hÆ¡n.
ÄÄƒng nháº­p
ÄÄƒng kÃ­